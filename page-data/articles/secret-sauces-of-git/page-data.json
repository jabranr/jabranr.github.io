{"componentChunkName":"component---src-templates-post-js","path":"/articles/secret-sauces-of-git/","result":{"data":{"site":{"siteMetadata":{"title":"Jabran Rafique - Software Engineer (Web)","author":"Jabran Rafique"}},"markdownRemark":{"id":"9cbc14f0-37b0-5863-b7a4-e35f19828efe","excerpt":"As part of agile workflow at Rated People we use Atlassian JIRA – tightly coupled with many other integrated technologies – all together making a combined…","html":"<p class=\"lead\">Git is an essential part of my daily workflow. There are certain awkward situations that require use of certain Git commands that are normally not part of regular workflows.</p>\n<p>As part of agile workflow at <a href=\"http://ratedpeople.com\">Rated People</a> we use <a href=\"http://atlassian.com/jira\">Atlassian JIRA</a> – tightly coupled with many other integrated technologies – all together making a combined workflow of TDD, CD and CI. To make sure JIRA tickets are tracked correctly we enforce that each commit message should include JIRA ticket number in it. On failing to do so developers get an error and not able to push changes to remote.</p>\n<h3>Update last commit message:</h3>\n<p>Let’s say, I forgot to add JIRA ticket number in a commit that I just finalised. Now I cannot push the changes until commit message is updated with a JIRA ticket number. In such situation, to edit most recent commit message I use following Git command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> commit --amend</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>This will open commit message in default Git editor where I can edit the commit message and save the changes. Now I can push the latest commits with no problem.</p>\n<blockquote>\n<p>You can set a default Git editor using <code class=\"language-text\">$ git config --global core.editor {editor_name}</code> where replace <code class=\"language-text\">editor_name</code> with correct editor name i.e. vim, pico, nano etc.</p>\n</blockquote>\n<h3>Update few commit messages:</h3>\n<p>But sometimes when I have some <a href=\"http://soundcloud.com/jabran-rafique\">good music</a> going in the headphones, I may randomly forget to add JIRA ticket number in multiple commit messages. In such case, above command to amend the last commit message is not useful anymore. Instead following command that uses <code class=\"language-text\">rebase</code> with a flag and number of commits to amend works better:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> rebase -i HEAD~<span class=\"token punctuation\">{</span>n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where <code class=\"language-text\">n</code> is number of commits to be listed. Here comes the interesting part as this command is completed in following two steps:</p>\n<h4>Step 1</h4>\n<p>Opens a list of specified number of commits in default editor in following format.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">pick commit_hash commit_message</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>To update a commit message, we replace <code class=\"language-text\">pick</code> with <code class=\"language-text\">reword</code> and above line becomes:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">reword commit_hash commit_message</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<blockquote>\n<p>Beware that removing a complete line will result in lost of commit.</p>\n</blockquote>\n<p>At the bottom it also lists out all the available options.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token comment\"># Commands:</span>\n<span class=\"token comment\"># p, pick = use commit</span>\n<span class=\"token comment\"># r, reword = use commit, but edit the commit message</span>\n<span class=\"token comment\"># e, edit = use commit, but stop for amending</span>\n<span class=\"token comment\"># s, squash = use commit, but meld into previous commit</span>\n<span class=\"token comment\"># f, fixup = like \"squash\", but discard this commit's log message</span>\n<span class=\"token comment\"># x, exec = run command (the rest of the line) using shell</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Saving the changes completes step 1 and enters into step 2.</p>\n<h4>Step 2</h4>\n<p>Each commit prefixed with word <code class=\"language-text\">reword</code> will open one after each other where commit messages can be updated as required. Save and exit to update the commit messages.</p>\n<h3>Pushing updated commit messages:</h3>\n<p>Now like me, if you were too quick to push the changes to remote then you cannot push any changes made to the commits using one of the above methods. Use <code class=\"language-text\">--force</code> flag to push changes to remote with updated commits.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> push origin HEAD --force</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>Remove remote branch:</h3>\n<p>Sometimes we create unwanted or wrong branches in remote but unable to delete those – perhaps due to limited permissions. Use following Git command to permanently delete a branch in remote:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> push origin --delete <span class=\"token punctuation\">{</span>branch_name<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<blockquote>\n<p>Beware that this action CANNOT be undone. A branch deleted from remote cannot easily be recovered so proceed with caution and backup branches first.</p>\n</blockquote>\n<h3>Add changes to finalised commit:</h3>\n<p>Sometimes we finalise commits only to realise that there were few more changes that could have been part of the same commit. Enter Git soft reset:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> reset --soft HEAD~<span class=\"token punctuation\">{</span>n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where <code class=\"language-text\">n</code> is a number of one finalised commit message that will be reset softly. Once done with further changes use following command to finalise the commit again by retaining the existing commit message.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> commit -c ORIG_MSG</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>Fancy Git log:</h3>\n<p>A last but not lease and my favourite Git log command is combination of multiple flags that outputs an interactive view of Git history.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> log -<span class=\"token punctuation\">{</span>n<span class=\"token punctuation\">}</span> --oneline --stats --color --graph --pretty</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where <code class=\"language-text\">n</code> is number of commits to be shown as part of the log.</p>","timeToRead":3,"frontmatter":{"title":"Secret sauces of Git","code":null,"date":"June 10, 2016"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/articles/secret-sauces-of-git/","previous":{"fields":{"slug":"/articles/css-pseudo-elements/"},"frontmatter":{"title":"CSS pseudo elements","permalink":null}},"next":{"fields":{"slug":"/articles/using-dry-in-symfony2-entities/"},"frontmatter":{"title":"Using DRY concept in Symfony2 Entities","permalink":null}}}}}